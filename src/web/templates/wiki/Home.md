![logo](/static/images/logo.png)

## _Добро пожаловать на ZIEM_   

> Здесь вы можете найти полезную информацию о системе  
> На данной странице кратко описан принцип работы системы  
> Для более подробной информации обратитесь к интересующим разделам  

##### Содержание  

[Цель](#target)  
[Описание](#info)  
[Таксономия](#tax)  
[Централизованное управление](#central)  

<a name="target"/>

## Цель
</a>  

- собрать `данные` от различных источников АСУТП
- определить только `необходимые` события
- вычислить `инциденты` из событий


<a name="info"/>

## Описание  
</a>  

> `ZIEM` работает на модульной архитектуре  
> От источников АСУТП поступают `сырые` данные  
> Модуль `Логирования` формирует `сообщение`  
> Модуль `Нормализация` ищет необходимое `событие`  
> Модуль `Корреляция` обрабатывает цепочки событий и формирует `инцидент`  
> Модуль `Отправки` передает информацию во внешние системы  

![logo](/static/images/data-flow.png)

<a name="tax"/>

## Таксономия  
</a>  

Принцип работы `ZIEM` построен на упрощенной схеме определения `таксономии` у события  
Для работы правил нормализации и корреляции выделено 3 группы `таксономии`  

- `таксономия основная` определяет принадлежность события к группе источников  
-- *АРМ*  
-- *АСО*  
-- *ПЛК*  

- `объект` определяет кто участвует в событии  
-- *Пользователь*  
-- *Конфигурация*  

- `действие` определяет что совершено объектом  
-- *Вход*  
--  *Изменение*  

Получаются `цепочки таксономии`, которые легко укладываются в правила корреляции  

- *АРМ : Пользователь : Вход*  
- *АРМ : Конфигурация : Изменение*  


### Примеры  
Простое правило корреляции  

- `сценарий` *Добавлен новый пользователь в операционной системе*  
-- `таксономия` *АРМ : Пользователь : Добавление*  
- `инцидент` *Создана новая учетная запись на АРМ*  

Cложное правило корреляции с фильтрацией по полям  

- `сценарий` *Подключение к сетевому оборудованию с неразрешенного адреса*  
-- `таксономия` *АСО : Пользователь : Успешный вход*  
-- `исключающий фильтр` *IP источника*  
- `инцидент` *Подключение с неразрешенного IP к АСО*  

Cложное правило с корреляции нескольких событий  

- `сценарий` *Изменение конфигурации системы, затем применение настроек путем ее перезагрузки*  
-- `таксономия` *АРМ : Конфигурация : Изменение*  
-- `таксономия` *АРМ : Операционная система : Старт*  
-- `время` *1 час*  
- `инцидент` *Изменение конфигурации АРМ и перезагрузка в течение 1 часа*  

Cложное правило корреляции с агрегацией событий  

- `сценарий` *Попытка подбора учетной записи сетевого оборудования*  
-- `таксономия` *АСО : Пользователь : Неуспешный вход*  
-- `время` *5 минут*  
-- `агрегация` *5*  
- `инцидент` *5 неуспешных попыток входа в АСО за 5 минут*  

Cложное правило корреляции с контролем значения поля  

- `сценарий` *Изменение контрольной суммы проекта среднего уровня*  
-- `таксономия` *ПЛК : Приложение : Проверка*    
-- `контроль поля` *контрольная сумма проекта*  
- `инцидент` *Новая контрольная сумма проекта на ПЛК*  


<a name="central"/>

## Централизованное управление  
</a>  

> Обновление ZIEM происходит при помощи `Агента`  
> Агент работает как отдельный сервис и не зависит от ZIEM  
> Обновление происходит `снизу-вверх`, запросы делает сам агент  

![logo](/static/images/wiki-central.png)

При периодическом подключении агент  

- отдает `версию` установленного ZIEM и агента  
- запрашивает необходимо ли обновление и актуальную конфигурацию  
- отдает сообщения из журнала ошибок  
- обновляет самого себя и ZIEM  

