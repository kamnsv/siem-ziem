![logo](/static/images/logo.png)

### _Руководство пользователя_  

> Данное руководство содержит необходимую информацию по работе c системой  

##### Содержание  

[Важная информация](#link_info)  
[Таксономия](#link_tax)  
[Объекты](#link_obj)  
[Логирование](#link_log)  
[Нормализацие](#link_nor)  
[Корреляцие](#link_cor)  
[Данные](#link_rep)  
[Тестирование](#link_test)   
[Параметры](#link_opt)   
[Настройка](#link_setting)   
[Главная](#link_main)  

<a name="link_info"/>

## Важная информация  
</a>  

Работа происходит со следующими `типами` данных  

- `сообщение` сырые данные от источника  
- `событие` нормализованные данные  
- `инцидент` скоррелированные данные  


<a name="link_tax"/>

## Таксономия  
</a>  

> Принцип работы `ZIEM` построен на упрощенной схеме определения `таксономии` у события. 

Для работы правил нормализации и корреляции выделено 3 группы `таксономии`  

- `таксономия основная` определяет принадлежность события к группе источников  
-- *АРМ*  
-- *АСО*  
-- *ПЛК*  

- `объект` определяет кто участвует в событии  
-- *Пользователь*  
-- *Конфигурация*  

- `действие` определяет что совершено объектом  
-- *Вход*  
--  *Изменение*  

- Получаются `цепочки таксономии`, которые легко укладываются в правила корреляции  
-- *АРМ : Пользователь : Вход*  
-- *АРМ : Конфигурация : Изменение*  


<a name="link_obj"/>

## Объекты  
</a>  

> Вкладка `Объекты` предназначена для централизованного управления `агентами`  
> Агенты представляют из себя отдельный сервис для управления ZIEM   
> С помощью агентов можно устанавливать обновления, правила

### Агенты  

> На вкладке `Правила` представлена основная информаци об агентах  

Панель действий  

- `добавить` правило позволяет создать новое правило  
- имеется возможность `удалить` правило  

Редактирование правила  

- `название` содержит кратное уникальное обозначение  
- `описание` содержит подробную информацию  
- `ip адрес Sender` указывает адрес куда отправлять инциденты  
- `переподключение объекта` одноразовый пароль для установки соединения с агентом  

- `управление агентом` позволяет обновлять агента/ZIEM, конфигурацию и правила  
<a name="link_log"/>

## Логирование  
</a>  

> Подсистема `Логирования` предназначена для сбора `сообщений` с различных источников    
> Сообщения представляют из себя `сырые` данные от источника  

### Источники  

> На вкладке `Правила` представлена основная информаци об источниках сбора  

Панель действий  

- `добавить` правило позволяет создать новое правило  
- возможно `сохранить` конфигурацию в файл  
- импортировать/экспортировать при помощи формата `json`  
- имеется возможность `копировать, удалить` правило  

Редактирование правила  

- `название` содержит кратное уникальное обозначение  
- `описание` содержит подробную информацию  
- `ip адрес` указывает адрес источника  
- `port` указывает порт источника  
- `ip резервный адрес` указывает резервный адрес источника  
- `port резервный` указывает резервный порт источника  
- `протокол` определяет способ подключения к источнику    
-- *WMI, Syslog, FTP, OPC UA*   
- `контроль потока` фиксирует отсутствие сообщений от источника  
- `пользователь` определяет учетную запись для подключения к источнику  
- `журналы` указывают откуда непосредственно забирать сообщения   
-- `название` определяет имя журнала  
-- `описание` содержит подробную информацию о журнале  
-- `правило нормализации` определяет каким правилом обрабатывать сообщения  
- `активный источник` определяет применение правила   

### Логины  

> На вкладке `Логины` представлена информаци об учетных записях для подключения к источникам  

Панель действий  

- `добавить` правило позволяет создать новую учетную запись  
- имеется возможность `удалить` учетную запись  

Редактирование учетной записи  

- `пользователь` определяет имя учетной записи для подключения к источнику  
- `описание` содержит подробную информацию  
- необходимо указать `пароль` от учетной записи  


<a name="link_nor"/>

## Нормализация  
</a>  

> Подсистема `Нормализация` предназначена для поиска необходимых `событий`,  
> а также для формирования `полей` событий из сообщений  

### Правила  

> На вкладке `Правила` представлена основная информаци  

Панель действий  

- `добавить` правило позволяет создать новое правило  
- возможно `сохранить` конфигурацию в файл  
- импортировать/экспортировать при помощи формата `json`  
- имеется возможность `синхронизировать, копировать, проверить, удалить` правило  

Редактирование правила  

- `название` содержит кратное уникальное обозначение  
- `описание` содержит подробную информацию  
- `профиль` определяет метод обработки сообщения  
- `таксономия основная` указывает принадлежность к группе источников  
- `события` содержат перечень необходимой информации  
-- `искомая строка` определяет что искать  
-- `событие` задает нормализованное значение  
-- `объект` указывает кто участвует в событии  
-- `действие` указывает что совершено объектом  
-- `поля нормализации` вычисляют необходимые значения из сообщения  

> Вычисление полей происходит с помощью полнотекстового поиска  
> `%s` вычисляет одно слово после выражения  
> `%a` вычисляет все слова в выражении  

### Пример  

```
<166>Apr 30 2020 11:34:58: %ASA-6-611102: User authentication failed: IP address: 192.168.0.180, Uname: admin

событие:             Неуспешная аутентификация
искомая строка:      %ASA-6-611102
основная таксономия: АСО
объект:              Пользователь
действие:            Неуспешный вход
поля нормализации  
    пользователь:    Uname: %s    
    адрес источника: IP address: %a,  
```

### Проверка правила  

> Позволяет проверить правило на наличие недостающей таксономии,  
> которая применяется в правилах корреляции  

- `недостающая` указывает какой таксономии не хватает и в каком правиле используется  
- `используемая` показывает в каком правиле применяется  
- `неиспользуемая` показывает какая таксономия еще не применяется в правилах корреляции  

<a name="link_cor"/>

## Корреляция  
</a>  

> Подсистема `Корреляции` предназначена для обработки событий  
> и формирования `инцидентов` информационной безопасности  
> Корреляция состоит из двух видов `простая` и `сложная` 

### Простая  

> `простая` корреляция используется, когда одно событие равно инциденту  
> при этом не надо ничего фильтровать и вычислять  

Панель действий  

- `добавить` правило позволяет создать новое правило  
- возможно `сохранить` конфигурацию в файл  
- импортировать/экспортировать при помощи формата `json`  
- имеется возможность `синхронизировать, копировать, удалить` правило  

Редактирование правила  

- `название` содержит кратное уникальное обозначение  
- `описание` содержит подробную информацию  
- `критичность` определяет уровень инцидента  
- `таксономия основная` указывает принадлежность к группе источников  
- `объект` указывает кто участвует в событии  
- `действие` указывает что совершено объектом  

### Сложная  

> `сложная` корреляция используется, когда необходимы дополнительные вычисления  

Панель действий  

- `добавить` правило позволяет создать новое правило  
- возможно `сохранить` конфигурацию в файл  
- импортировать/экспортировать при помощи формата `json`  
- имеется возможность `синхронизировать, копировать, удалить` правило  

Редактирование правила  

- `название` содержит кратное уникальное обозначение  
- `описание` содержит подробную информацию  
- `критичность` определяет уровень инцидента  
- `уникальное поле` разделяет события по определенному полю  
- `таймер` определяет максимальный временной интервал между событиями  
- `события` содержат перечень необходимой нормализованной информации  
-- `таксономия основная` указывает принадлежность к группе источников  
-- `объект` указывает кто участвует в событии  
-- `действие` указывает что совершено объектом  
-- `агрегация` показывает количество необходимых событий  
-- `контроль` указывает какое поле необходимо контролировать  
-- `включающий фильтр` определяет события попадающие в инцидент  
-- `исключающий фильтр` определяет события не попадающие в инцидент  

### Примеры  

Простое правило  
```
название:                ARM_UserAdd
описание:                Создана новая учетная запись на АРМ
критичность:             Высокая
таксономия:              АРМ : Пользователь : Добавление
```
Cложное правило с фильтрацией по полям  
```
название:                ARM_LoginRDP
описание:                Удаленный вход по RDP на АРМ
критичность:             Высокая
события    
    таксономия:          АРМ : Пользователь : Успешный вход  
    включающий фильтр:   Привилегия = 3, 11  
    исключающий фильтр:  Адрес источника = 192.168.2.2  
```
Cложное правило с корреляции нескольких событий
```
название:                ARM_ConfChangeReboot
описание:                Изменение конфигурации АРМ и перезагрузка в течение 1 часа
критичность:             Высокая
уникальное поле:         Адрес источника события
таймер:                  3600
события    
    таксономия:          АРМ : Конфигурация : Изменение  
    таксономия:          АРМ : Операционная система : Старт  
```

Cложное правило с агрегацией событий  
```
название:                ASO_Login5Fail  
описание:                5 неуспешных попыток входа в АСО за 5 минут  
критичность:             Средняя  
уникальное поле:         Адрес источника события  
уникальное поле:         Пользователь  
таймер:                  300  
события  
    таксономия:          АСО : Пользователь : Неуспешный вход  
    агрегация:           5  
```
Cложное правило с контролем значения поля
```
название:                PLC_ProjectCrcChange  
описание:                Новая контрольная сумма проекта на ПЛК  
критичность:             Высокая
уникальное поле:         Адрес источника события
события:  
    таксономия:          ПЛК : Приложение : Проверка  
    контроль:            Контрольная сумма
```

<a name="link_rep"/>

## Данные  
</a>  

> Подсистема `Данные` предназначена для просмотра сообщений, событий, инцидентов  
> Возможен полнотекстовый поиск по инцидентам, событиям и сообщениям
 
<a name="link_test"/>

## Тестирование  
</a>  

> Позволяет проверять доступность источников и каналов связи  
> Отправлять тестовые сообщения в ядро системы  

- `Nmap` простая проверка доступности источника с помощью ICMP запроса  
- `WMI` проверка подключения к источнику по WMI  
- `FTP` проверка подключения к источнику по FTP  
- `OPCUA` проверка подключения к источнику по OPC UA  
-- необходимо добавить правило логирования с адресом источника 127.0.0.1  


<a name="link_opt"/>

## Параметры  
</a>  

> Позволяет изменять таксономию, протоколы, профили, поля, критичность, классификатор,  

Редактирование правила  

- `название` содержит кратное уникальное обозначение  
- `описание` содержит подробную информацию  


<a name="link_setting"/>

## Настройка  
</a>  

> Позволяет изменять основные параметры системы,
> просматривать журналы, импортировать/экспортировать настройки

Настройка

- `название коррелятора` задает уникальное название с привязкой к месту установки  
- `IP адрес сендера` указывает адрес Сендера, куда отправлять инциденты  
- `PORT сендера` указывает порт Сендера,куда отправлять инциденты  
- `IP адрес OPC сервера` указывает адрес OPC сервера, куда отправлять инциденты    
- `PORT OPC сервера` указывает порт OPC сервера,куда отправлять инциденты  
- `текущая версия` показывает актуальную версию системы 
- `IP адрес сервера обновлений` задает адрес сервера, откуда брать обновления  
- `PORT сервера обновлений` задает порт сервера, откуда брать обновления  

Журнал системы

- Просмотр логов и анализ работы системы  
- Возможен полнотекстовый поиск по сообщениям в журнале  

Журнал действий

- Просмотр действий пользователей в WEB интерфейсе системы  
- Возможен полнотекстовый поиск по сообщениям в журнале  

Экспорт/импорт

- Резервное копирование и восстановление всей конфигурации системы 

Пользователи

- Управление пользователями системы 

<a name="link_main"/>

## Главная  
</a>  

Сатус

> Предоставляет Дашбоард с основной информацией о работе системы  
> Установка правил в ядро системы  
> Управление работой ядра системы  
> Просмотр сатистических данных о работе системы    

