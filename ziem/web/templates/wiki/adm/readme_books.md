![logo](/static/images/logo.png)

### _Руководство по настройки обновления справочников_  


> Данное руководство содержит необходимую информацию по настройки обновления справочников

##### Содержание  

[Информация](#info)  
[Добавление](#add)  
[Источник](#api)  
[Примеры](#exl)  


<a name=info>
## Информация 
</a>

Справочники используются в корреляции сложных инцидентов.
Любому нормализованному полю можно назначить включающий/исключающий фильтр по значению и справочники.

<a name=add>
## Добавление 
</a>

Справочники создаются в меню `Параметры` -> `Справочники`.
После добавления справочника, появляется меню `Справочники`, в котором доступен сам справочник для внесения и изменения данных.


<a name=api>
## Источник 
</a>

Для обновления справочников в автоматическом режиме с периодичностью 1 раз в день, можно назначить API-источник, который возвращает данные в формате JSON.
Контроль обновления справочников осуществляет модуль `ZIEMAGENT`.

Парсинг данных из JSON задается универсально по значениям `Список`, `Значение`. Данные параметры имеют формат в виде последовательности ключей через точку. 

При получении данных от источника алгоритм находит ключ `списка` и начинает его итерировать. Далее в полученных *i-эх* элементах находится ключ `Значение` и значение поля вносится в целевое значение справочника, а остальные поля в описательную часть.

При связи ZIEM-CC с агентами, в качестве API источников передается API самого ZIEM-CC, т.к. ZIEM-CC в качестве proxy-сервера, при этом все поля `Список`, `Значение` остаются прежними. API-токен агентам не передается.

<a name=exl>
## Примеры 
</a>

### Первый пример


```json
{ "data": [ 
    { 
        "content": "hasher.exe", 
        "desc": "Шифровщик данных" 
    }, 
    { 
        "content": "kill.exe", 
        "desc": "ПО деструктуризации данных"
    }, 
    { "content": "hack.exe", 
     "desc": "Хакерское ПО" } 
    ]
}
```
> Здесь итерируемы список ключ *data*.

`Список`: data, 
`Значение`: content

### Второй пример

```json
{ "data": 
 { "list": [ 
     { "content": "hasher.exe", "desc": "Шифровщик данных" }, 
     { "content": "kill.exe", "desc": "ПО деструктуризации данных" }, 
     { "content": "hack.exe", "desc": "Хакерское ПО" } 
     ] 
 }
}
```

> Тут список *list* находится под ключем *data*.


`Список`: data.list, 
`Значение`: content

### Третий пример

```json
{ "data": 
 { "list": [ 
     { "content": 
      { "desc": "Шифровщик данных", "item": "hasher.exe" } 
     }, 
     { "content": 
      { "desc": "ПО деструктуризации данных", "item": "kill.exe" }
     }, 
     { "content": 
      { "desc": "Хакерское ПО", "item": "hack.exe" } 
     } 
 ] 
 } 
}
```

> Здесь и список *list* и данные спрятаны под ключами.

`Список`: data.list, 
`Значение`: content.item


### Четвертый пример


```json
[ 
 { "content": "hasher.exe", "desc": "Шифровщик данных" }, 
 { "content": "kill.exe", "desc": "ПО деструктуризации данных" }, 
 { "content": "hack.exe", "desc": "Хакерское ПО" } 
]
```

> Этот вариант, когда возвращается список с объектами

`Список`: , - *пусто*
`Значение`: content